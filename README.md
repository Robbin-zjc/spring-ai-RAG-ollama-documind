# Spring AI RAG æ–‡æ¡£é—®ç­”ç³»ç»Ÿ

<div align="center">

<!-- é¡¹ç›® Logo -->
<img src="logo.png" alt="DocuMind Logo" width="280" style="border-radius: 12px;"/>

<!-- åŠ¨æ€æ ‡é¢˜æ•ˆæœ -->
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="https://readme-typing-svg.demolab.com?font=Fira+Code&size=32&duration=2000&pause=1000&color=6DB33F&center=true&vCenter=true&width=600&lines=ğŸ“šğŸ¤–+Spring+AI+RAG+æ–‡æ¡£é—®ç­”ç³»ç»Ÿ">
  <img alt="Typing SVG" src="https://readme-typing-svg.demolab.com?font=Fira+Code&size=32&duration=2000&pause=1000&color=6DB33F&center=true&vCenter=true&width=600&lines=ğŸ“šğŸ¤–+Spring+AI+RAG+æ–‡æ¡£é—®ç­”ç³»ç»Ÿ">
</picture>

<!-- å¾½ç« è¡Œ1ï¼šé¡¹ç›®ç»Ÿè®¡ -->
<br>
[![GitHub stars](https://img.shields.io/github/stars/Robbin-zjc/-spring-ai-RAG-ollama-documind?style=for-the-badge&logo=github)](https://github.com/Robbin-zjc/-spring-ai-RAG-ollama-documind/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/Robbin-zjc/-spring-ai-RAG-ollama-documind?style=for-the-badge&logo=github)](https://github.com/Robbin-zjc/-spring-ai-RAG-ollama-documind/network)
[![GitHub issues](https://img.shields.io/github/issues/Robbin-zjc/-spring-ai-RAG-ollama-documind?style=for-the-badge&logo=github)](https://github.com/Robbin-zjc/-spring-ai-RAG-ollama-documind/issues)
[![License](https://img.shields.io/badge/license-MIT-blue?style=for-the-badge)](LICENSE)

<!-- å¾½ç« è¡Œ2ï¼šæŠ€æœ¯æ ˆ -->
<br><br>
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.4.1-brightgreen?style=flat-square&logo=spring-boot)
![Java](https://img.shields.io/badge/Java-21-orange?style=flat-square&logo=openjdk)
![Spring AI](https://img.shields.io/badge/Spring%20AI-1.0.0--M5-blue?style=flat-square)
![Ollama](https://img.shields.io/badge/Ollama-Llama%203.2-black?style=flat-square)
![PGVector](https://img.shields.io/badge/PGVector-0.7.0-blue?style=flat-square&logo=postgresql)

<!-- å¾½ç« è¡Œ3ï¼šç‰¹æ€§ -->
<br>
![RAG](https://img.shields.io/badge/RAG-System-purple?style=flat-square)
![æœ¬åœ°éƒ¨ç½²](https://img.shields.io/badge/æœ¬åœ°éƒ¨ç½²-âœ“-success?style=flat-square)
![å¼€æº](https://img.shields.io/badge/å¼€æº-â¤-red?style=flat-square)

<!-- å¯¼èˆªé“¾æ¥ -->
<br><br>
<p>
  <a href="#-åŠŸèƒ½ç‰¹æ€§"><b>åŠŸèƒ½ç‰¹æ€§</b></a> â€¢
  <a href="#-å¿«é€Ÿå¼€å§‹"><b>å¿«é€Ÿå¼€å§‹</b></a> â€¢
  <a href="#-api-ä½¿ç”¨"><b>API æ–‡æ¡£</b></a> â€¢
  <a href="#ï¸-é…ç½®è¯´æ˜"><b>é…ç½®è¯´æ˜</b></a>
</p>

</div>

---

**åŸºäº Spring AI + Ollama + PGVector çš„æœ¬åœ°éƒ¨ç½² RAG ç³»ç»Ÿ**

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

- âœ… **PDF æ–‡æ¡£ä¸Šä¼ ** - æ”¯æŒå¤§å‹ PDF æ–‡ä»¶çš„è§£æå’Œå‘é‡åŒ–
- âœ… **æ™ºèƒ½æ£€ç´¢** - åŸºäºè¯­ä¹‰çš„æ–‡æ¡£ç‰‡æ®µæ£€ç´¢
- âœ… **æ··åˆæœç´¢** - ä¸»æ£€ç´¢ + å¤šè½®è¡¥å……æ£€ç´¢ï¼Œæé«˜å¬å›ç‡
- âœ… **åŠ¨æ€ä¼˜åŒ–** - æ ¹æ®é—®é¢˜ç±»å‹è‡ªåŠ¨è°ƒæ•´æ£€ç´¢å‚æ•°
- âœ… **æœ¬åœ°éƒ¨ç½²** - å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œæ•°æ®éšç§å®‰å…¨
- âœ… **å¤šæ–‡æ¡£ç®¡ç†** - æ”¯æŒå¤šä¸ªæ–‡æ¡£çš„ç»Ÿä¸€é—®ç­”

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Spring Boot | 3.4.1 | åç«¯æ¡†æ¶ |
| Spring AI | 1.0.0-M5 | RAG æ¡†æ¶ |
| Ollama | Latest | æœ¬åœ° LLM æœåŠ¡ |
| Llama 3.2 | Latest | å¤§è¯­è¨€æ¨¡å‹ |
| PGVector | 0.7.0 | å‘é‡æ•°æ®åº“ |
| PostgreSQL | 16 | å…³ç³»æ•°æ®åº“ |
| Apache Tika | - | PDF è§£æ |

## ğŸ“¦ ç³»ç»Ÿæ¶æ„

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¯·æ±‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DocumentController (APIå±‚) â”‚
â”‚ - POST /api/upload ä¸Šä¼ PDF â”‚
â”‚ - GET /api/documents æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨ â”‚
â”‚ - POST /api/query æ™ºèƒ½é—®ç­” â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAGService (ä¸šåŠ¡é€»è¾‘å±‚) â”‚
â”‚ - hybridSearch() æ··åˆæ£€ç´¢ â”‚
â”‚ - buildPrompt() æ„å»ºPrompt â”‚
â”‚ - é—®é¢˜ç±»å‹è¯†åˆ« + åŠ¨æ€å‚æ•°è°ƒæ•´ â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”‚
â–¼ â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VectorStore â”‚ â”‚ ChatClient â”‚
â”‚ (PGVector) â”‚ â”‚ (Ollama LLM) â”‚
â”‚ å‘é‡æ£€ç´¢ â”‚ â”‚ ç”Ÿæˆç­”æ¡ˆ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

text

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ å‰ç½®è¦æ±‚

- â˜• Java 21+
- ğŸ³ Docker Desktop
- ğŸ“¦ Maven 3.8+
- ğŸ’¾ 8GB+ å†…å­˜ï¼ˆç”¨äºè¿è¡Œ Ollamaï¼‰

### âš¡ ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

#### Windows ç”¨æˆ·
```cmd
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/spring-ai-rag-ollama.git
cd spring-ai-rag-ollama

# 2. åŒå‡»è¿è¡Œ
start.bat
Mac/Linux ç”¨æˆ·
bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/spring-ai-rag-ollama.git
cd spring-ai-rag-ollama

# 2. ä¸€é”®å¯åŠ¨
./start.sh
å¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨ï¼š

âœ… æ£€æŸ¥ Docker çŠ¶æ€

âœ… å¯åŠ¨ PGVector æ•°æ®åº“

âœ… æ£€æŸ¥ Ollama æœåŠ¡

âœ… å¯åŠ¨ Spring Boot åº”ç”¨

ğŸ¤– é¦–æ¬¡ä½¿ç”¨éœ€è¦å®‰è£… Ollama
1. ä¸‹è½½å®‰è£… Ollama

Windows/Mac: https://ollama.ai/download

Linux: curl -fsSL https://ollama.ai/install.sh | sh

2. æ‹‰å–æ‰€éœ€æ¨¡å‹

bash
# æ‹‰å– LLM æ¨¡å‹ï¼ˆçº¦ 2GBï¼‰
ollama pull llama3.2

# æ‹‰å–åµŒå…¥æ¨¡å‹ï¼ˆçº¦ 270MBï¼‰
ollama pull nomic-embed-text

# éªŒè¯å®‰è£…
ollama list
âœ… éªŒè¯è¿è¡Œ
è®¿é—® http://localhost:8080ï¼Œæˆ–æ‰§è¡Œï¼š

bash
# æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨ï¼ˆåˆå§‹ä¸ºç©ºï¼‰
curl http://localhost:8080/api/documents
ğŸ“– API ä½¿ç”¨
1ï¸âƒ£ ä¸Šä¼ æ–‡æ¡£
bash
curl -X POST http://localhost:8080/api/upload \
  -F "file=@/path/to/document.pdf"
å“åº”ç¤ºä¾‹ï¼š

text
æ–‡ä»¶ä¸Šä¼ å¹¶å¯¼å…¥æˆåŠŸ: 1770468280000_document.pdf
2ï¸âƒ£ æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨
bash
curl http://localhost:8080/api/documents
å“åº”ç¤ºä¾‹ï¼š

json
[
  {
    "id": 1,
    "filename": "document.pdf",
    "fullPath": "1770468280000_document.pdf",
    "chunkCount": 7
  }
]
3ï¸âƒ£ æ™ºèƒ½é—®ç­”
bash
curl -X POST http://localhost:8080/api/query \
  -H "Content-Type: application/json" \
  -d '{"question":"æ–‡æ¡£çš„ä¸»è¦å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ"}'
å“åº”ç¤ºä¾‹ï¼š

json
{
  "answer": "æ ¹æ®æ–‡æ¡£å†…å®¹ï¼Œä¸»è¦è®¨è®ºäº†...",
  "sources": ["document.pdf"],
  "question": "æ–‡æ¡£çš„ä¸»è¦å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ",
  "retrievedChunks": 7
}
âš™ï¸ é…ç½®è¯´æ˜
åŸºç¡€é…ç½®
ç¼–è¾‘ src/main/resources/application.properties:

text
# æ•°æ®åº“é…ç½®
spring.datasource.url=jdbc:postgresql://localhost:5432/vectordb
spring.datasource.username=testuser
spring.datasource.password=testpwd

# Ollama é…ç½®
spring.ai.ollama.base-url=http://localhost:11434
spring.ai.ollama.chat.model=llama3.2:latest
spring.ai.ollama.embedding.model=nomic-embed-text

# RAG æ£€ç´¢é…ç½®
rag.search.topk=20                      # æ£€ç´¢æ–‡æ¡£æ•°é‡
rag.search.similarity-threshold=0.25     # ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆ0-1ï¼‰
é«˜çº§é…ç½®
ä¿®æ”¹æ–‡æ¡£åˆ‡åˆ†å‚æ•°ï¼ˆDocumentController.java ç¬¬ 72 è¡Œï¼‰ï¼š

java
// chunk å¤§å°, overlap, æœ€å°é•¿åº¦, æœ€å¤§é•¿åº¦, ä¿ç•™æ¢è¡Œ
TokenTextSplitter(600, 150, 5, 10000, true)
ä¿®æ”¹æ£€ç´¢ç­–ç•¥ï¼ˆRAGService.javaï¼‰ï¼š

java
// åˆ—ä¸¾ç±»é—®é¢˜çš„æ£€ç´¢å€æ•°
private double listingMultiplier = 1.5;

// ç²¾ç¡®æŸ¥æ‰¾é—®é¢˜çš„æ£€ç´¢å€æ•°
private double precisionMultiplier = 0.7;
ğŸ¯ æ ¸å¿ƒä¼˜åŒ–
1. æ··åˆæ£€ç´¢ç­–ç•¥
ä¸»æ£€ç´¢ï¼šä½¿ç”¨ç”¨æˆ·åŸå§‹é—®é¢˜

è¡¥å……æ£€ç´¢ 1ï¼šæå–å…³é”®è¯æ£€ç´¢

è¡¥å……æ£€ç´¢ 2ï¼šä½¿ç”¨å®½æ³›å…³é”®è¯ï¼ˆå¦‚"åˆ†ç±» æ˜Ÿçº§"ï¼‰

è‡ªåŠ¨é‡è¯•ï¼šå¦‚æœç»“æœå°‘äº 8 ä¸ªï¼Œé™ä½é˜ˆå€¼é‡è¯•

2. æ™ºèƒ½æ–‡æ¡£åˆ‡åˆ†
Chunk Size: 600 tokensï¼ˆçº¦ 400 æ±‰å­—ï¼‰

Overlap: 150 tokensï¼ˆä¿ç•™ä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼‰

ä¼˜åŠ¿ï¼šé¿å…çŸ­å¥è¢«å•ç‹¬åˆ‡åˆ†ï¼Œæé«˜æ£€ç´¢å‡†ç¡®ç‡

3. é—®é¢˜ç±»å‹è¯†åˆ«
åˆ—ä¸¾ç±»ï¼ˆ"æœ‰å“ªäº›"ã€"åˆ†ä¸ºå‡ ä¸ª"ï¼‰â†’ å¢åŠ æ£€ç´¢é‡ï¼Œé™ä½é˜ˆå€¼

ç²¾ç¡®æŸ¥æ‰¾ï¼ˆ"æ˜¯ä»€ä¹ˆ"ã€"å®šä¹‰"ï¼‰â†’ å‡å°‘æ£€ç´¢é‡ï¼Œæé«˜é˜ˆå€¼

4. Prompt å·¥ç¨‹
æ˜ç¡®æŒ‡ä»¤çº¦æŸï¼ˆ"ä»…åŸºäºæ–‡æ¡£å›ç­”"ï¼‰

å¼ºè°ƒå®Œæ•´æ€§ï¼ˆ"ä¸è¦é—æ¼ä»»ä½•ä¿¡æ¯"ï¼‰

æ ¼å¼åŒ–è¾“å‡ºï¼ˆ"å…ˆæ€»ç»“ï¼Œå†å±•å¼€"ï¼‰

ğŸ“Š æ€§èƒ½æŒ‡æ ‡
æŒ‡æ ‡	æ•°å€¼
å¹³å‡æ£€ç´¢è€—æ—¶	~200ms
å¹³å‡ç”Ÿæˆè€—æ—¶	~3-5s
æ£€ç´¢å‡†ç¡®ç‡	>90%
æ–‡æ¡£å¤„ç†é€Ÿåº¦	~1é¡µ/ç§’
å†…å­˜å ç”¨	~2GB (åº”ç”¨) + 4GB (Ollama)
ğŸ”§ æ•…éšœæ’æŸ¥
æ•°æ®åº“è¿æ¥å¤±è´¥
bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# åº”è¯¥çœ‹åˆ°ï¼š
# NAME        STATUS              PORTS
# pgvector    Up (healthy)        0.0.0.0:5432->5432/tcp

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs postgres

# é‡å¯æ•°æ®åº“
docker-compose restart postgres
Ollama è¿æ¥å¤±è´¥
bash
# æ£€æŸ¥ Ollama æ˜¯å¦è¿è¡Œ
curl http://localhost:11434/api/tags

# æŸ¥çœ‹å·²å®‰è£…æ¨¡å‹
ollama list

# é‡æ–°æ‹‰å–æ¨¡å‹
ollama pull llama3.2
ollama pull nomic-embed-text
æ£€ç´¢ç»“æœä¸ºç©º
bash
# 1. æ£€æŸ¥æ˜¯å¦æœ‰æ–‡æ¡£
curl http://localhost:8080/api/documents

# 2. å¦‚æœä¸ºç©ºï¼Œé‡æ–°ä¸Šä¼ 
curl -X POST http://localhost:8080/api/upload -F "file=@document.pdf"

# 3. ç¡®è®¤æ•°æ®åº“ä¸­æœ‰æ•°æ®
docker exec -it pgvector psql -U testuser -d vectordb
SELECT COUNT(*) FROM vector_store;
\q
ç«¯å£è¢«å ç”¨
å¦‚æœ 5432 ç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ docker-compose.yml:

text
ports:
  - "5433:5432"  # æ”¹ç”¨ 5433 ç«¯å£
ç„¶åä¿®æ”¹ application.properties:

text
spring.datasource.url=jdbc:postgresql://localhost:5433/vectordb
ğŸ›‘ åœæ­¢æœåŠ¡
åœæ­¢åº”ç”¨
åœ¨è¿è¡Œçª—å£æŒ‰ Ctrl+C

åœæ­¢æ•°æ®åº“
bash
# åœæ­¢ä½†ä¿ç•™æ•°æ®
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆæ•°æ®ä¼šä¿ç•™åœ¨ volume ä¸­ï¼‰
docker-compose down

# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰æ•°æ®ï¼ˆè°¨æ…æ“ä½œï¼ï¼‰
docker-compose down -v
ğŸ“ å¼€å‘è·¯çº¿å›¾
 åŸºç¡€ RAG åŠŸèƒ½

 PDF æ–‡æ¡£ä¸Šä¼ 

 æ··åˆæ£€ç´¢ç­–ç•¥

 åŠ¨æ€å‚æ•°è°ƒæ•´

 Docker Compose éƒ¨ç½²

 æµå¼è¿”å›ç­”æ¡ˆ

 Web å‰ç«¯ç•Œé¢

 å¤šè½®å¯¹è¯æ”¯æŒ

 æ”¯æŒ Word/Markdown

 é‡æ’åºï¼ˆRerankingï¼‰

 å¤šæ–‡æ¡£è”åˆé—®ç­”

 å¼•ç”¨æ ‡æ³¨

ğŸ¤ è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

Fork æœ¬ä»“åº“

åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (git checkout -b feature/AmazingFeature)

æäº¤æ›´æ”¹ (git commit -m 'Add some AmazingFeature')

æ¨é€åˆ°åˆ†æ”¯ (git push origin feature/AmazingFeature)

å¼€å¯ Pull Request

ğŸ“„ è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ LICENSE æ–‡ä»¶

ğŸ‘¨â€ğŸ’» ä½œè€…
 jiachengzhu@Robbin-zjc
ğŸ™ è‡´è°¢
Spring AI - RAG æ¡†æ¶

Ollama - æœ¬åœ° LLM æœåŠ¡

PGVector - PostgreSQL å‘é‡æ‰©å±•

Meta Llama - å¤§è¯­è¨€æ¨¡å‹

ğŸ“® è”ç³»æ–¹å¼
å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

æäº¤ Issue

é‚®ç®±ï¼šjiacheng-zhu@foxmail.com
<div align="center"> â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼ </div> ```